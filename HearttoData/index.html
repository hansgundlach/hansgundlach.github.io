<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- cdn make it quick-->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


<div class = "container">
<div class="jumbotron center" color ="orange">
  <h1>HEARTMUSIC</h1>
  <p>play the music of your heart</p>
</div>
</div>


  <div class="form-group">
good heart rate based on age: <input type="text" id="nameField" placeholder="150"> </input>
<button class="btn btn-primary btn-lg" id="submitName">Submit</button>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​
  </div>


<!--volume?</button>
<button onclick="setHalfVolume()" type="button">Set volume to 0.2</button>
<button onclick="setFullVolume()" type="button">Set volume to 1.0</button><br>-->

<!--<video id="myMusic" width="320" height="176" controls>
  <source src="mov_bbb.mp4" type="video/mp4">
  Your browser does not support HTML5 video.
</video>-->
<div>
<p class="text-left"> Fast Music </p>
<audio class = "myMusicFast" id="myMusicFast" onended="endfunc()" controls>
  <!--<source src="horse.ogg" type="audio/ogg">-->
  <source src="Hampster.mp3" type="audio/mpeg">
Your browser does not support the audio element.
</audio>
</div>


<div>
<p class="text-left"> Slow Music </p>
<audio class = "myMusicSlow" onended= "endfunc()" id="myMusicSlow" controls>
  <!--<source src="horse.ogg" type="audio/ogg">-->
  <source src="Simon.mp3" type="audio/mpeg">
Your browser does not support the audio element.
</audio>
</div>






<script>

//learn how to make API fitbit jQuery
//GET https://api.fitbit.com/1/user/-/activities/heart/date/today/1d.json













//switch to slow song if you are too Slow
function endfunc() {



      //try to see if you can get wrolling average
      var something = Math.random();
      //list_lastten.push(something);
      //console.log(list_lastten);
      if(something > 0.6){
        console.log("half time");
        document.getElementById("myMusicFast").play();
      }else {
        console.log("below half");
        document.getElementById("myMusicSlow").play();
  }
}

//get user input




//get optimal heartrate
  function myFunction() {
      document.getElementById("myForm").submit();
  }


/*var myVar = setInterval(myTimer,3000);
console.log(myVar);
var list_lastten = [];*/



//immitating having fit bit API
//quiets music every few minutes



$(document).ready(function() {
  var myVar = setInterval(myTimer,3000);
  console.log(myVar);
  var list_lastten = [];
  var heartset = 150;
  function myTimer(){
      // randheart goes from 140 t0 160
      //random number 140 plus or minus 10
      var randheart = 140 + 20*Math.random();

      list_lastten.push(randheart);
      list_lastten.pop();
//calculate new average
      var total = 0;
      for(var i = 0; i < list_lastten.length; i++) {
        total += list_lastten[i];
      }
      var avg_last = total / list_lastten.length;
      //console.log(list_lastten);
      //if you need to slow down
      if(randheart > heartset){
        console.log(randheart);
        console.log("slow down");
        setHalfVolume();
        //if you need to speed up
      }else if(randheart < heartset - 5){
        console.log(randheart);
        console.log("speed up");
        setSpeedUp()
        //if your running is just right
      }else{
        console.log("just right")
        console.log(randheart)
        console.log(heartset)
        setFullVolume();

      }

  }
   $("#submitName").click(function() {

   heartset=  $("#nameField").val();

       console.log(heartset);

   });
 });


/*function myTimer(){
     var something = Math.random();
    list_lastten.push(something);
    //console.log(list_lastten);
    if(something > 0.5){
      console.log("half time");
      setHalfVolume()
    }else {
      console.log("below half");
      setFullVolume()
    }

}*/



var vid = document.getElementById("myMusicFast");
var othervid = document.getElementById("myMusicSlow")
function getVolume() {
    alert(vid.volume);
}

function setHalfVolume() {
     vid.playbackRate = 0.4;
    vid.volume = 0.1;
    othervid.volume = 0.5;
    othervid.playbackRate = 0.4;
}



function setFullVolume() {
  vid.playbackRate = 1.0;
    othervid.volume = 1.0;
    vid.volume = 1.0;
    othervid.playbackRate = 1.0;
}


function setSpeedUp() {
vid.playbackRate = 2;
othervid.playbackRate =2;
vid.volume = 1;
othervid.volume = 1;

}


</script>
